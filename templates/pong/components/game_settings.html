{% load static %}

<div id="game-settings" class="card mb-4">
    <div class="card-header">
        <h5 class="mb-0">Game Settings</h5>
    </div>
    <div class="card-body">
        <!-- Settings form for room owner -->
        <form id="settings-form"
            v-if="pongRoom.settings && !pongRoom.gameStarted && pongRoom.owner && pongRoom.currentUser && pongRoom.owner.id === pongRoom.currentUser.id">
            <!-- Paddle Speed -->
            <div class="mb-3">
                <label for="paddleSpeed" class="form-label">Paddle Speed</label>
                <input type="range" class="form-range" id="paddleSpeed" min="1" max="10" step="1"
                    v-model="pongRoom.settings.paddleSpeed"
                    v-on:input="pongRoom.handleSettingChange('paddleSpeed', $event.target.value, true)">
                <div class="d-flex justify-content-between">
                    <span>Slow</span>
                    <span>Fast</span>
                </div>
            </div>

            <!-- Ball Speed -->
            <div class="mb-3">
                <label for="ballSpeed" class="form-label">Ball Speed</label>
                <input type="range" class="form-range" id="ballSpeed" min="1" max="10" step="1"
                    v-model="pongRoom.settings.ballSpeed"
                    v-on:input="pongRoom.handleSettingChange('ballSpeed', $event.target.value, true)">
                <div class="d-flex justify-content-between">
                    <span>Slow</span>
                    <span>Fast</span>
                </div>
            </div>

            <!-- Paddle Size -->
            <div class="mb-3">
                <label for="paddleSize" class="form-label">Paddle Size</label>
                <input type="range" class="form-range" id="paddleSize" min="1" max="10" step="1"
                    v-model="pongRoom.settings.paddleSize"
                    v-on:input="pongRoom.handleSettingChange('paddleSize', $event.target.value, true)">
                <div class="d-flex justify-content-between">
                    <span>Small</span>
                    <span>Large</span>
                </div>
            </div>

            <!-- Max Score -->
            <div class="mb-3">
                <label for="maxScore" class="form-label">Points to Win</label>
                <select class="form-select" id="maxScore" v-model="pongRoom.settings.maxScore"
                    v-on:input="pongRoom.handleSettingChange('maxScore', $event.target.value, true)">
                    <option value="5">5 Points</option>
                    <option value="11">11 Points</option>
                    <option value="21">21 Points</option>
                </select>
            </div>

            <!-- AI Difficulty (only shown in AI mode) -->
            <div class="mb-3" v-if="pongRoom.mode === 'AI'">
                <label for="aiDifficulty" class="form-label">AI Difficulty</label>
                <select class="form-select" id="aiDifficulty" v-model="pongRoom.settings.aiDifficulty"
                    v-on:input="pongRoom.handleSettingChange('aiDifficulty', $event.target.value, false)">
                    <option value="EASY">Easy</option>
                    <option value="MEDIUM">Medium</option>
                    <option value="HARD">Hard</option>
                </select>
            </div>
        </form>

        <!-- Read-only settings display -->
        <div v-if="pongRoom.settings && pongRoom.gameStarted">
            <div class="mb-3">
                <label class="form-label">Game Mode</label>
                <p class="mb-0" v-text="pongRoom.mode"></p>
            </div>

            <div class="mb-3">
                <label class="form-label">Paddle Speed</label>
                <div class="progress">
                    <div class="progress-bar" role="progressbar" v-text="pongRoom.settings.paddleSpeed + '/10'"
                        v-bind:style="pongRoom.getProgressBarStyle(pongRoom.settings.paddleSpeed)">
                    </div>
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label">Ball Speed</label>
                <div class="progress">
                    <div class="progress-bar" role="progressbar" v-text="pongRoom.settings.ballSpeed + '/10'"
                        v-bind:style="pongRoom.getProgressBarStyle(pongRoom.settings.ballSpeed)">
                    </div>
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label">Paddle Size</label>
                <div class="progress">
                    <div class="progress-bar" role="progressbar" v-text="pongRoom.settings.paddleSize + '%'"
                        v-bind:style="pongRoom.getProgressBarStyle(pongRoom.settings.paddleSize)">
                    </div>
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label">Points to Win</label>
                <p class="mb-0" v-text="pongRoom.settings.maxScore + ' Points'"></p>
            </div>

            <div class="mb-3" v-if="pongRoom.mode === 'AI'">
                <label class="form-label">AI Difficulty</label>
                <p class="mb-0" v-text="pongRoom.settings.aiDifficulty"></p>
            </div>
        </div>

        <!-- No settings message -->
        <div v-if="!pongRoom.settings" class="alert alert-warning">
            Loading settings...
        </div>
    </div>
</div>